


<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta property="og:title" content="glearn.GaussianProcess.plot_likelihood" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://ameli.github.io/generated/glearn.GaussianProcess.plot_likelihood.html" />
<meta property="og:site_name" content="g-learn" />
<meta property="og:image" content="https://raw.githubusercontent.com/ameli/glearn/main/docs/source/_static/images/icons/logo-glearn-light.svg" />
<meta property="og:image:alt" content="g-learn" />
<meta property="og:title" content="RestoreIO">
<meta property="og:description" content="g-learn is a modular and high-performance Python package for machine learning using Gaussian process regression with novel algorithms capable of petascale computation on multi-GPU devices.">

    <title>glearn.GaussianProcess.plot_likelihood &#8212; glearn Manual</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "auto";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom-pydata.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/toggleprompt.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/custom-pydata.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}, "tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/custom-pydata.css"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="glearn.kernels.Kernel" href="glearn.kernels.Kernel.html" />
    <link rel="prev" title="glearn.GaussianProcess.predict" href="glearn.GaussianProcess.predict.html" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RCTBMM27GH"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-RCTBMM27GH');
    </script>

    <script defer data-domain="docs.scipy.org" src="https://views.scientific-python.org/js/script.js"></script>

    <!-- My custom JS -->
    <script type="text/javascript" src="../_static/js/custom-pydata.js"></script>

    <!-- Syntax highlighting for BibTex code blocks -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism-solarizedlight.min.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs-bibtex@2.0.1/prism-bibtex.min.js"></script>

    
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">

  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="auto">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../contents.html">
  
  
  
  
    <img src="../_static/images/icons/logo-glearn-light.png" class="logo__image only-light" alt="Logo image">
    <img src="../_static/images/icons/logo-glearn-dark.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../install/install.html">
  Install
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../docker/docker.html">
  Docker
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../gpu/gpu.html">
  GPU
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../api.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../tutorials/tutorials.html">
  Tutorials
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/ameli/glearn" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://pypi.org/project/glearn/" rel="noopener" target="_blank" title="PyPI"><span><i class="fab fa-python"></i></span>
            <label class="sr-only">PyPI</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://anaconda.org/s-ameli/glearn" rel="noopener" target="_blank" title="Anaconda Cloud"><span><i class="fa fa-circle-notch"></i></span>
            <label class="sr-only">Anaconda Cloud</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://hub.docker.com/r/sameli/glearn" rel="noopener" target="_blank" title="Docker Hub"><span><i class="fab fa-docker"></i></span>
            <label class="sr-only">Docker Hub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://mybinder.org/v2/gh/ameli/glearn/HEAD?filepath=notebooks%2FInterpolateTraceOfInverse.ipynb" rel="noopener" target="_blank" title="Lanuch Jupyter on Binder"><span><i class="fas fa-book-open"></i></span>
            <label class="sr-only">Lanuch Jupyter on Binder</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Linear Model
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.LinearModel.html">
   glearn.LinearModel
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.Covariance.html">
   glearn.Covariance
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="glearn.GaussianProcess.html">
   glearn.GaussianProcess
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="glearn.GaussianProcess.train.html">
     glearn.GaussianProcess.train
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="glearn.GaussianProcess.predict.html">
     glearn.GaussianProcess.predict
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     glearn.GaussianProcess.plot_likelihood
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Kernels
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.kernels.Kernel.html">
   glearn.kernels.Kernel
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.kernels.Exponential.html">
   glearn.kernels.Exponential
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.kernels.SquareExponential.html">
   glearn.kernels.SquareExponential
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.kernels.Linear.html">
   glearn.kernels.Linear
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.kernels.RationalQuadratic.html">
   glearn.kernels.RationalQuadratic
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.kernels.Matern.html">
   glearn.kernels.Matern
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Prior Distributions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.priors.Prior.html">
   glearn.priors.Prior
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.priors.Uniform.html">
   glearn.priors.Uniform
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.priors.Normal.html">
   glearn.priors.Normal
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.priors.Cauchy.html">
   glearn.priors.Cauchy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.priors.StudentT.html">
   glearn.priors.StudentT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.priors.Erlang.html">
   glearn.priors.Erlang
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.priors.Gamma.html">
   glearn.priors.Gamma
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.priors.InverseGamma.html">
   glearn.priors.InverseGamma
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.priors.BetaPrime.html">
   glearn.priors.BetaPrime
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Sample Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.sample_data.generate_points.html">
   glearn.sample_data.generate_points
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.sample_data.generate_data.html">
   glearn.sample_data.generate_data
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Device Inquiry
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.Timer.html">
   glearn.Timer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.Memory.html">
   glearn.Memory
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.info.html">
   glearn.info
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.device.get_processor_name.html">
   glearn.device.get_processor_name
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.device.get_gpu_name.html">
   glearn.device.get_gpu_name
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.device.get_num_cpu_threads.html">
   glearn.device.get_num_cpu_threads
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.device.get_num_gpu_devices.html">
   glearn.device.get_num_gpu_devices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.device.get_nvidia_driver_version.html">
   glearn.device.get_nvidia_driver_version
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.device.locate_cuda.html">
   glearn.device.locate_cuda
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glearn.device.restrict_to_single_processor.html">
   glearn.device.restrict_to_single_processor
  </a>
 </li>
</ul>

    
  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#glearn.GaussianProcess.plot_likelihood">
   <code class="docutils literal notranslate">
    <span class="pre">
     GaussianProcess.plot_likelihood()
    </span>
   </code>
  </a>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      

<div class="tocsection editthispage">
    <a href="https://github.com/ameli/glearn/edit/main/docs/source/generated/glearn.GaussianProcess.plot_likelihood.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="glearn-gaussianprocess-plot-likelihood">
<h1>glearn.GaussianProcess.plot_likelihood<a class="headerlink" href="#glearn-gaussianprocess-plot-likelihood" title="Permalink to this heading">#</a></h1>
<dl class="py method">
<dt class="sig sig-object py" id="glearn.GaussianProcess.plot_likelihood">
<span class="sig-prename descclassname"><span class="pre">GaussianProcess.</span></span><span class="sig-name descname"><span class="pre">plot_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profile_hyperparam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'var'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#glearn.GaussianProcess.plot_likelihood" title="Permalink to this definition">#</a></dt>
<dd><p>Plot the likelihood function and its derivatives with respect to the
hyperparameters.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>z</strong><span class="classifier">numpy.array</span></dt><dd><p>An array of the size <span class="math notranslate nohighlight">\(n\)</span> representing the training data.
If <cite>z</cite> is not provided (set to <cite>None</cite>), the training data that used
to define the <a class="reference internal" href="glearn.GaussianProcess.html#glearn.GaussianProcess" title="glearn.GaussianProcess"><code class="xref py py-class docutils literal notranslate"><span class="pre">glearn.GaussianProcess</span></code></a> class is used.</p>
</dd>
<dt><strong>profile_hyperparam</strong><span class="classifier">{<cite>‘none’</cite>, <cite>‘var’</cite>, <cite>‘var_noise’</cite>}, default:                <cite>‘var’</cite></span></dt><dd><p>The type of likelihood profiling method to be used in optimization
of the likelihood function.</p>
<ul class="simple">
<li><p>When <code class="docutils literal notranslate"><span class="pre">profile_likelihood</span></code> is set to <code class="docutils literal notranslate"><span class="pre">none</span></code>, the likelihood
function explicitly depends on the two hyperparameters
<span class="math notranslate nohighlight">\(\sigma\)</span> and <span class="math notranslate nohighlight">\(\varsigma\)</span>.</p></li>
<li><p>When <code class="docutils literal notranslate"><span class="pre">profile_likelihood</span></code> is set to <code class="docutils literal notranslate"><span class="pre">var</span></code>, the likelihood
function depends on the two hyperparameters
<span class="math notranslate nohighlight">\(\eta=\varsigma^2/\sigma^2\)</span>, which is profiles over
the hyperparameter <span class="math notranslate nohighlight">\(\sigma\)</span>, reducing the number of the
hyperparameters by one.</p></li>
<li><p>When <code class="docutils literal notranslate"><span class="pre">profile_likelihood</span></code> is set to <code class="docutils literal notranslate"><span class="pre">var_sigma</span></code>, the
likelihood function is profiles over both <span class="math notranslate nohighlight">\(\sigma\)</span> and
<span class="math notranslate nohighlight">\(\eta\)</span>, reducing the number of unknown hyperparameters
by two.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function plots likelihood function and its first and second
derivatives with respect to the hyperparameters. The type of
hyperparameters depend on the profiling method which is set by
<code class="docutils literal notranslate"><span class="pre">profile_hyperparam</span></code>.</p>
<p>This function is only used for testing purposes, and can only plot
1D and 2D data.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function may take a long time, and is only used for testing
purposes on small datasets.</p>
</div>
<p>Note that the maximum points of the likelihood plots may not
correspond to the optimal values of the hyperparameters. This is
because the hyperparameters are found by the maximum points of the
posterior function. If the prior for the scale hyperparameter is the
uniform distribution, then the likelihood and the posterior functions
are them same and the maxima of the likelihood function in the plots
correspond to the optimal hyperparameters.</p>
<p class="rubric">Examples</p>
<p>To define a Gaussian process object <span class="math notranslate nohighlight">\(\mathcal{GP}(\mu,
\Sigma)\)</span>, first, an object for the linear model where <span class="math notranslate nohighlight">\(\mu\)</span> and
an object for the covariance model <span class="math notranslate nohighlight">\(\Sigma\)</span> should be created as
follows.</p>
<p><strong>1. Generate Sample Training Data:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">glearn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">glearn</span> <span class="kn">import</span> <span class="n">sample_data</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate a set of training points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">sample_data</span><span class="o">.</span><span class="n">generate_points</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">num_points</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">contrast</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate noise sample data on the training points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_noisy</span> <span class="o">=</span> <span class="n">glearn</span><span class="o">.</span><span class="n">sample_data</span><span class="o">.</span><span class="n">generate_data</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">noise_magnitude</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>2. Create Linear Model:</strong></p>
<p>Create an object for <span class="math notranslate nohighlight">\(\mu\)</span> function using
<a class="reference internal" href="glearn.LinearModel.html#glearn.LinearModel" title="glearn.LinearModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">glearn.LinearModel</span></code></a> class. On training points, the mean
function is represented by the array</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\mu} = \boldsymbol{\phi}^{\intercal}
(\boldsymbol{x}) \boldsymbol{\beta}.\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create mean object using glearn.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">glearn</span><span class="o">.</span><span class="n">LinearModel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">polynomial_degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>3. Create Covariance Object:</strong></p>
<p>Create the covariance model using <a class="reference internal" href="glearn.Covariance.html#glearn.Covariance" title="glearn.Covariance"><code class="xref py py-class docutils literal notranslate"><span class="pre">glearn.Covariance</span></code></a> class. On
the training points, the covariance function is represented by the
matrix</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\Sigma}(\sigma, \varsigma, \boldsymbol{\alpha}) =
\sigma^2 \mathbf{K}(\boldsymbol{\alpha}) +
\varsigma^2 \mathbf{I}.\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define a Cauchy prior for scale hyperparameter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale</span> <span class="o">=</span> <span class="n">glearn</span><span class="o">.</span><span class="n">priors</span><span class="o">.</span><span class="n">Cauchy</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a covariance object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cov</span> <span class="o">=</span> <span class="n">glearn</span><span class="o">.</span><span class="n">Covariance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>4. Create Gaussian Process Object:</strong></p>
<p>Putting all together, we can create an object for <span class="math notranslate nohighlight">\(\mathcal{GP}
(\mu, \Sigma)\)</span> as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Gaussian process object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gp</span> <span class="o">=</span> <span class="n">glearn</span><span class="o">.</span><span class="n">GaussianProcess</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">cov</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>5. Train The Model:</strong></p>
<p>Train the model to find the regression parameter
<span class="math notranslate nohighlight">\(\boldsymbol{\beta}\)</span> and the hyperparameters <span class="math notranslate nohighlight">\(\sigma\)</span>,
<span class="math notranslate nohighlight">\(\varsigma\)</span>, and <span class="math notranslate nohighlight">\(\boldsymbol{\alpha}\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Train</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">y_noisy</span><span class="p">,</span> <span class="n">profile_hyperparam</span><span class="o">=</span><span class="s1">&#39;var&#39;</span><span class="p">,</span> <span class="n">log_hyperparam</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">hyperparam_guess</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">optimization_method</span><span class="o">=</span><span class="s1">&#39;Newton-CG&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">tol</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">use_rel_error</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">imate_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;cholesky&#39;</span><span class="p">},</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Plotting:</strong></p>
<p>After the  training when the hyperparameters were tuned, plot the
likelihood function as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot likelihood function and its derivatives</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gp</span><span class="o">.</span><span class="n">plot_likelihood</span><span class="p">()</span>
</pre></div>
</div>
<a class="custom-dark reference internal image-reference" href="../_images/gp_likelihood_var_1.png"><img alt="../_images/gp_likelihood_var_1.png" class="custom-dark align-center" src="../_images/gp_likelihood_var_1.png" style="width: 100%;" /></a>
<a class="custom-dark reference internal image-reference" href="../_images/gp_likelihood_var_2.png"><img alt="../_images/gp_likelihood_var_2.png" class="custom-dark align-center" src="../_images/gp_likelihood_var_2.png" style="width: 100%;" /></a>
<a class="custom-dark reference internal image-reference" href="../_images/gp_likelihood_var_3.png"><img alt="../_images/gp_likelihood_var_3.png" class="custom-dark align-center" src="../_images/gp_likelihood_var_3.png" style="width: 100%;" /></a>
<p>If we set <code class="docutils literal notranslate"><span class="pre">profile_likelihood=none</span></code>, the followings will be plotted
instead:</p>
<a class="custom-dark reference internal image-reference" href="../_images/gp_likelihood_none_1.png"><img alt="../_images/gp_likelihood_none_1.png" class="custom-dark align-center" src="../_images/gp_likelihood_none_1.png" style="width: 100%;" /></a>
<a class="custom-dark reference internal image-reference" href="../_images/gp_likelihood_none_2.png"><img alt="../_images/gp_likelihood_none_2.png" class="custom-dark align-center" src="../_images/gp_likelihood_none_2.png" style="width: 100%;" /></a>
<a class="custom-dark reference internal image-reference" href="../_images/gp_likelihood_none_3.png"><img alt="../_images/gp_likelihood_none_3.png" class="custom-dark align-center" src="../_images/gp_likelihood_none_3.png" style="width: 100%;" /></a>
</dd></dl>

</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="glearn.GaussianProcess.predict.html" title="previous page">
      <i class="fas fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">glearn.GaussianProcess.predict</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="glearn.kernels.Kernel.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">glearn.kernels.Kernel</p>
  </div>
  <i class="fas fa-angle-right"></i>
  </a>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>


    <!-- Adobe Embed API -->
    
    <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>


  </body>
</html>